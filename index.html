<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AE2i - Base de donn√©es</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #fbbf24 100%);
            min-height: 100vh;
            color: #1f2937;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #6b7280;
            margin-bottom: 30px;
        }

        input[type="password"], input[type="text"], input[type="email"], input[type="tel"], 
        input[type="date"], textarea, select, input[type="file"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #1e40af, #3b82f6);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f59e0b, #fbbf24);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc2626, #ef4444);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #059669, #10b981);
            color: white;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .main-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-top: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .nav-tabs {
            display: flex;
            background: #f8fafc;
            border-bottom: 2px solid #e5e7eb;
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            min-width: 120px;
        }

        .nav-tab:hover {
            background: #e0e7ff;
        }

        .nav-tab.active {
            background: #3b82f6;
            color: white;
            border-bottom-color: #fbbf24;
        }

        .tab-content {
            padding: 40px;
        }

        .hidden {
            display: none;
        }

        .member-card, .commission-card {
            background: #f8fafc;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .member-card:hover, .commission-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            border-color: #3b82f6;
        }

        .member-header, .commission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .member-name, .commission-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #1e40af;
        }

        .member-info, .commission-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 0.9em;
            color: #6b7280;
            margin-bottom: 5px;
        }

        .info-value {
            font-weight: 500;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e5e7eb;
        }

        .form-section h3 {
            color: #1e40af;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3b82f6;
        }

        .success-message {
            background: #d1fae5;
            border: 2px solid #10b981;
            color: #065f46;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .error-message {
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #991b1b;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .stat-card {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2);
            margin-bottom: 20px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .document-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid #e5e7eb;
        }

        .document-name {
            font-weight: 500;
            color: #0f172a;
        }

        .document-info {
            font-size: 0.9em;
            color: #64748b;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .form-grid, .form-row {
                grid-template-columns: 1fr;
            }
            
            .member-info, .commission-info {
                grid-template-columns: 1fr;
            }

            .member-header, .commission-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- √âcran de connexion -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="logo">AE2i</div>
            <div class="subtitle">Base de donn√©es universelle</div>
            <input type="password" id="passwordInput" placeholder="Mot de passe" />
            <button class="btn btn-primary" onclick="login()" style="width: 100%;">Se connecter</button>
            <div id="loginError" class="error-message hidden">Mot de passe incorrect</div>
        </div>
    </div>

    <!-- Interface principale -->
    <div id="mainApp" class="hidden">
        <div class="container">
            <div class="main-container">
                <div class="header">
                    <h1>AE2i - Gestion des donn√©es</h1>
                    <p>Base de donn√©es universelle synchronis√©e</p>
                </div>
                
                <div class="nav-tabs">
                    <div class="nav-tab active" onclick="showTab('dashboard')">Tableau de bord</div>
                    <div class="nav-tab" onclick="showTab('members')">Membres</div>
                    <div class="nav-tab" onclick="showTab('commissions')">Commissions</div>
                    <div class="nav-tab" onclick="showTab('documents')">Documents</div>
                    <div class="nav-tab" onclick="showTab('settings')">Param√®tres</div>
                </div>

                <!-- Onglet Tableau de bord -->
                <div id="dashboardTab" class="tab-content">
                    <h2>Tableau de bord AE2i</h2>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number" id="totalMembers">0</div>
                            <div class="stat-label">Membres totaux</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeMembers">0</div>
                            <div class="stat-label">Membres actifs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalCommissions">0</div>
                            <div class="stat-label">Commissions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalDocuments">0</div>
                            <div class="stat-label">Documents</div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Activit√© r√©cente</h3>
                        <div id="recentActivity">
                            <p style="color: #6b7280;">Aucune activit√© r√©cente</p>
                        </div>
                    </div>
                </div>

                <!-- Onglet Membres -->
                <div id="membersTab" class="tab-content hidden">
                    <h2>Gestion des Membres</h2>
                    
                    <div id="memberSuccess" class="success-message hidden">Membre sauvegard√© avec succ√®s !</div>
                    
                    <div class="form-section">
                        <h3>Ajouter un membre</h3>
                        <div class="form-grid">
                            <div>
                                <input type="text" id="memberName" placeholder="Nom complet *" />
                            </div>
                            <div>
                                <input type="email" id="memberEmail" placeholder="Email *" />
                            </div>
                            <div>
                                <input type="tel" id="memberPhone" placeholder="T√©l√©phone" />
                            </div>
                            <div>
                                <input type="date" id="memberJoinDate" />
                                <label style="font-size: 0.9em; color: #6b7280;">Date d'int√©gration *</label>
                            </div>
                            <div>
                                <input type="text" id="memberPosition" placeholder="Poste/Fonction" />
                            </div>
                            <div>
                                <input type="text" id="memberCompany" placeholder="Entreprise/Organisation" />
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div>
                                <select id="memberStatus">
                                    <option value="">Statut du membre</option>
                                    <option value="actif">Actif</option>
                                    <option value="inactif">Inactif</option>
                                    <option value="suspendu">Suspendu</option>
                                    <option value="honoraire">Membre d'honneur</option>
                                </select>
                            </div>
                            <div>
                                <input type="text" id="memberAddress" placeholder="Adresse compl√®te" />
                            </div>
                        </div>
                        
                        <div>
                            <textarea id="memberNotes" placeholder="Notes suppl√©mentaires" rows="3"></textarea>
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveMember()">Ajouter Membre</button>
                        <button class="btn btn-warning" onclick="updateMember()" id="updateMemberBtn" style="display: none;">Mettre √† jour</button>
                        <button class="btn btn-danger" onclick="cancelEdit()" id="cancelEditBtn" style="display: none;">Annuler</button>
                    </div>
                    
                    <div id="membersList">
                        <!-- Les membres seront affich√©s ici -->
                    </div>
                </div>

                <!-- Onglet Commissions -->
                <div id="commissionsTab" class="tab-content hidden">
                    <h2>Gestion des Commissions</h2>
                    
                    <div id="commissionSuccess" class="success-message hidden">Commission sauvegard√©e avec succ√®s !</div>
                    
                    <div class="form-section">
                        <h3>Ajouter une commission</h3>
                        <div class="form-grid">
                            <div>
                                <input type="text" id="commissionName" placeholder="Nom de la commission *" />
                            </div>
                            <div>
                                <input type="text" id="commissionCode" placeholder="Code commission (ex: TRES, COMM)" />
                            </div>
                            <div>
                                <input type="text" id="commissionResponsible" placeholder="Responsable principal *" />
                            </div>
                            <div>
                                <input type="text" id="commissionAdjoint" placeholder="Adjoint" />
                            </div>
                            <div>
                                <input type="text" id="commissionSecretary" placeholder="Secr√©taire" />
                            </div>
                            <div>
                                <input type="text" id="commissionTreasurer" placeholder="Tr√©sorier (si applicable)" />
                            </div>
                        </div>
                        
                        <div>
                            <textarea id="commissionDescription" placeholder="Description de la commission" rows="3"></textarea>
                        </div>
                        
                        <div>
                            <textarea id="commissionSubCommissions" placeholder="Sous-commissions (une par ligne)" rows="4"></textarea>
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveCommission()">Ajouter Commission</button>
                        <button class="btn btn-warning" onclick="updateCommission()" id="updateCommissionBtn" style="display: none;">Mettre √† jour</button>
                        <button class="btn btn-danger" onclick="cancelCommissionEdit()" id="cancelCommissionEditBtn" style="display: none;">Annuler</button>
                    </div>
                    
                    <div id="commissionsList">
                        <!-- Les commissions seront affich√©es ici -->
                    </div>
                </div>

                <!-- Onglet Documents -->
                <div id="documentsTab" class="tab-content hidden">
                    <h2>Gestion des Documents</h2>
                    
                    <div id="documentSuccess" class="success-message hidden">Document enregistr√© avec succ√®s !</div>
                    <div id="documentError" class="error-message hidden"></div>
                    
                    <div class="form-section">
                        <h3>Ajouter un document</h3>
                        <div class="form-row">
                            <div>
                                <input type="text" id="documentTitle" placeholder="Titre du document *" />
                            </div>
                            <div>
                                <select id="documentCommission">
                                    <option value="">Associer √† une commission (optionnel)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div>
                                <input type="text" id="documentCategory" placeholder="Cat√©gorie (ex: Budget, Rapport)" />
                            </div>
                            <div>
                                <input type="text" id="documentAuthor" placeholder="Auteur/Cr√©ateur" />
                            </div>
                        </div>
                        
                        <div>
                            <input type="file" id="fileInput" accept=".xlsx,.xls,.pdf,.doc,.docx,.png,.jpg,.jpeg">
                            <p style="font-size: 0.9em; color: #6b7280; margin-top: 5px;">
                                Formats: Excel, PDF, Word, Images (Max: 50MB)
                            </p>
                        </div>
                        
                        <div>
                            <textarea id="documentDescription" placeholder="Description/Notes" rows="3"></textarea>
                        </div>
                        
                        <div style="text-align: center;">
                            <button class="btn btn-primary" onclick="saveDocument()">üíæ Enregistrer le document</button>
                            <button class="btn btn-danger" onclick="clearDocumentForm()">üóëÔ∏è Vider</button>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>üìä T√©l√©chargements</h3>
                        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                            <p style="color: #92400e; margin: 0; text-align: center;">
                                üìç <strong>Les fichiers sont t√©l√©charg√©s dans :</strong><br>
                                Fichiers ‚Üí Sur mon iPhone ‚Üí T√©l√©chargements
                            </p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <button class="btn btn-success" onclick="exportMembersText()">üìä Membres</button>
                            <button class="btn btn-success" onclick="exportCommissionsText()">üìä Commissions</button>
                            <button class="btn btn-warning" onclick="exportDocumentsText()">üìã Documents</button>
                            <button class="btn btn-primary" onclick="exportAllData()">üìà Rapport complet</button>
                        </div>
                    </div>

                    <div id="documentsList" class="form-section">
                        <h3>Documents enregistr√©s</h3>
                        <div id="documentsContainer">
                            <p style="color: #6b7280; text-align: center;">Aucun document enregistr√©</p>
                        </div>
                    </div>
                </div>

                <!-- Onglet Param√®tres -->
                <div id="settingsTab" class="tab-content hidden">
                    <h2>Param√®tres</h2>
                    
                    <div id="settingsSuccess" class="success-message hidden">Param√®tres mis √† jour !</div>
                    <div id="passwordError" class="error-message hidden"></div>
                    
                    <div class="form-section">
                        <h3>Changer le mot de passe</h3>
                        <div style="max-width: 400px;">
                            <input type="password" id="currentPassword" placeholder="Mot de passe actuel" />
                            <input type="password" id="newPassword" placeholder="Nouveau mot de passe" />
                            <input type="password" id="confirmPassword" placeholder="Confirmer" />
                            <button class="btn btn-primary" onclick="changePassword()">Changer</button>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>Informations</h3>
                        <p>Derni√®re sauvegarde : <span id="lastSave">Jamais</span></p>
                        <p>Total enregistrements : <span id="totalRecords">0</span></p>
                        <br>
                        <button class="btn btn-danger" onclick="logout()">Se d√©connecter</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales - SIMPLE ET FONCTIONNEL
        let currentPassword = 'ae2i2024';
        let members = [];
        let commissions = [];
        let documents = [];
        let recentActivity = [];
        let editingMemberIndex = -1;
        let editingCommissionIndex = -1;

        // CONNEXION - SIMPLE
        function login() {
            const password = document.getElementById('passwordInput').value;
            if (password === currentPassword) {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                loadData();
                updateDashboard();
            } else {
                document.getElementById('loginError').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('loginError').classList.add('hidden');
                }, 3000);
            }
        }

        // ONGLETS
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            event.target.classList.add('active');

            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'documents') {
                updateCommissionsList();
                displayDocuments();
            }
        }

        // TABLEAU DE BORD
        function updateDashboard() {
            document.getElementById('totalMembers').textContent = members.length;
            document.getElementById('activeMembers').textContent = members.filter(m => m.status === 'actif').length;
            document.getElementById('totalCommissions').textContent = commissions.length;
            document.getElementById('totalDocuments').textContent = documents.length;
            document.getElementById('totalRecords').textContent = members.length + commissions.length + documents.length;

            const activityContainer = document.getElementById('recentActivity');
            if (recentActivity.length === 0) {
                activityContainer.innerHTML = '<p style="color: #6b7280;">Aucune activit√© r√©cente</p>';
            } else {
                activityContainer.innerHTML = '';
                recentActivity.slice(0, 5).forEach(activity => {
                    const div = document.createElement('div');
                    div.style.cssText = 'padding: 10px; margin-bottom: 10px; background: white; border-radius: 8px; border-left: 4px solid #3b82f6;';
                    div.innerHTML = `<strong>${activity.action}</strong> - ${activity.details}<br><small style="color: #6b7280;">${activity.date}</small>`;
                    activityContainer.appendChild(div);
                });
            }
        }

        // AJOUTER ACTIVIT√â
        function addActivity(action, details) {
            const activity = {
                action: action,
                details: details,
                date: new Date().toLocaleString('fr-FR')
            };
            recentActivity.unshift(activity);
            if (recentActivity.length > 20) {
                recentActivity = recentActivity.slice(0, 20);
            }
            saveData();
        }

        // MEMBRES
        function saveMember() {
            const name = document.getElementById('memberName').value;
            const email = document.getElementById('memberEmail').value;
            const joinDate = document.getElementById('memberJoinDate').value;
            
            if (!name || !email || !joinDate) {
                alert('Nom, email et date d\'int√©gration obligatoires');
                return;
            }

            const member = {
                id: Date.now(),
                name: name,
                email: email,
                phone: document.getElementById('memberPhone').value,
                position: document.getElementById('memberPosition').value,
                company: document.getElementById('memberCompany').value,
                address: document.getElementById('memberAddress').value,
                status: document.getElementById('memberStatus').value,
                notes: document.getElementById('memberNotes').value,
                joinDate: joinDate,
                dateAdded: new Date().toLocaleDateString('fr-FR')
            };

            members.push(member);
            addActivity('Nouveau membre', name + ' ajout√©');
            saveData();
            clearMemberForm();
            displayMembers();
            showSuccess('memberSuccess');
        }

        function updateMember() {
            const name = document.getElementById('memberName').value;
            const email = document.getElementById('memberEmail').value;
            const joinDate = document.getElementById('memberJoinDate').value;
            
            if (!name || !email || !joinDate) {
                alert('Nom, email et date d\'int√©gration obligatoires');
                return;
            }

            members[editingMemberIndex] = {
                ...members[editingMemberIndex],
                name: name,
                email: email,
                phone: document.getElementById('memberPhone').value,
                position: document.getElementById('memberPosition').value,
                company: document.getElementById('memberCompany').value,
                address: document.getElementById('memberAddress').value,
                status: document.getElementById('memberStatus').value,
                notes: document.getElementById('memberNotes').value,
                joinDate: joinDate
            };

            addActivity('Membre modifi√©', name);
            saveData();
            clearMemberForm();
            displayMembers();
            showSuccess('memberSuccess');
            cancelEdit();
        }

        function editMember(index) {
            const member = members[index];
            editingMemberIndex = index;

            document.getElementById('memberName').value = member.name;
            document.getElementById('memberEmail').value = member.email;
            document.getElementById('memberPhone').value = member.phone || '';
            document.getElementById('memberPosition').value = member.position || '';
            document.getElementById('memberCompany').value = member.company || '';
            document.getElementById('memberAddress').value = member.address || '';
            document.getElementById('memberStatus').value = member.status || '';
            document.getElementById('memberNotes').value = member.notes || '';
            document.getElementById('memberJoinDate').value = member.joinDate || '';

            document.getElementById('updateMemberBtn').style.display = 'inline-block';
            document.getElementById('cancelEditBtn').style.display = 'inline-block';
        }

        function deleteMember(index) {
            if (confirm('Supprimer ce membre ?')) {
                const name = members[index].name;
                members.splice(index, 1);
                addActivity('Membre supprim√©', name);
                saveData();
                displayMembers();
            }
        }

        function cancelEdit() {
            editingMemberIndex = -1;
            clearMemberForm();
            document.getElementById('updateMemberBtn').style.display = 'none';
            document.getElementById('cancelEditBtn').style.display = 'none';
        }

        function clearMemberForm() {
            document.getElementById('memberName').value = '';
            document.getElementById('memberEmail').value = '';
            document.getElementById('memberPhone').value = '';
            document.getElementById('memberPosition').value = '';
            document.getElementById('memberCompany').value = '';
            document.getElementById('memberAddress').value = '';
            document.getElementById('memberStatus').value = '';
            document.getElementById('memberNotes').value = '';
            document.getElementById('memberJoinDate').value = '';
        }

        function displayMembers() {
            const list = document.getElementById('membersList');
            list.innerHTML = '';

            members.forEach((member, index) => {
                const card = document.createElement('div');
                card.className = 'member-card';
                card.innerHTML = `
                    <div class="member-header">
                        <div class="member-name">${member.name}</div>
                        <div>
                            <button class="btn btn-warning btn-small" onclick="editMember(${index})">‚úèÔ∏è Modifier</button>
                            <button class="btn btn-danger btn-small" onclick="deleteMember(${index})">üóëÔ∏è Supprimer</button>
                        </div>
                    </div>
                    <div class="member-info">
                        <div class="info-item">
                            <div class="info-label">Email</div>
                            <div class="info-value">${member.email}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">T√©l√©phone</div>
                            <div class="info-value">${member.phone || 'Non renseign√©'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Poste</div>
                            <div class="info-value">${member.position || 'Non renseign√©'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Entreprise</div>
                            <div class="info-value">${member.company || 'Non renseign√©'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Statut</div>
                            <div class="info-value">${member.status || 'Non d√©fini'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Date d'int√©gration</div>
                            <div class="info-value">${member.joinDate || 'Non renseign√©'}</div>
                        </div>
                    </div>
                    ${member.notes ? `<div style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px;"><strong>Notes:</strong> ${member.notes}</div>` : ''}
                `;
                list.appendChild(card);
            });
        }

        // COMMISSIONS
        function saveCommission() {
            const name = document.getElementById('commissionName').value;
            const responsible = document.getElementById('commissionResponsible').value;
            
            if (!name || !responsible) {
                alert('Nom et responsable obligatoires');
                return;
            }

            const commission = {
                id: Date.now(),
                name: name,
                code: document.getElementById('commissionCode').value,
                responsible: responsible,
                adjoint: document.getElementById('commissionAdjoint').value,
                secretary: document.getElementById('commissionSecretary').value,
                treasurer: document.getElementById('commissionTreasurer').value,
                description: document.getElementById('commissionDescription').value,
                subCommissions: document.getElementById('commissionSubCommissions').value.split('\n').filter(sub => sub.trim()),
                dateAdded: new Date().toLocaleDateString('fr-FR')
            };

            commissions.push(commission);
            addActivity('Nouvelle commission', name + ' ajout√©e');
            saveData();
            clearCommissionForm();
            displayCommissions();
            showSuccess('commissionSuccess');
        }

        function updateCommission() {
            const name = document.getElementById('commissionName').value;
            const responsible = document.getElementById('commissionResponsible').value;
            
            if (!name || !responsible) {
                alert('Nom et responsable obligatoires');
                return;
            }

            commissions[editingCommissionIndex] = {
                ...commissions[editingCommissionIndex],
                name: name,
                code: document.getElementById('commissionCode').value,
                responsible: responsible,
                adjoint: document.getElementById('commissionAdjoint').value,
                secretary: document.getElementById('commissionSecretary').value,
                treasurer: document.getElementById('commissionTreasurer').value,
                description: document.getElementById('commissionDescription').value,
                subCommissions: document.getElementById('commissionSubCommissions').value.split('\n').filter(sub => sub.trim())
            };

            addActivity('Commission modifi√©e', name);
            saveData();
            clearCommissionForm();
            displayCommissions();
            showSuccess('commissionSuccess');
            cancelCommissionEdit();
        }

        function editCommission(index) {
            const commission = commissions[index];
            editingCommissionIndex = index;

            document.getElementById('commissionName').value = commission.name;
            document.getElementById('commissionCode').value = commission.code || '';
            document.getElementById('commissionResponsible').value = commission.responsible;
            document.getElementById('commissionAdjoint').value = commission.adjoint || '';
            document.getElementById('commissionSecretary').value = commission.secretary || '';
            document.getElementById('commissionTreasurer').value = commission.treasurer || '';
            document.getElementById('commissionDescription').value = commission.description || '';
            document.getElementById('commissionSubCommissions').value = commission.subCommissions ? commission.subCommissions.join('\n') : '';

            document.getElementById('updateCommissionBtn').style.display = 'inline-block';
            document.getElementById('cancelCommissionEditBtn').style.display = 'inline-block';
        }

        function deleteCommission(index) {
            if (confirm('Supprimer cette commission ?')) {
                const name = commissions[index].name;
                commissions.splice(index, 1);
                addActivity('Commission supprim√©e', name);
                saveData();
                displayCommissions();
            }
        }

        function cancelCommissionEdit() {
            editingCommissionIndex = -1;
            clearCommissionForm();
            document.getElementById('updateCommissionBtn').style.display = 'none';
            document.getElementById('cancelCommissionEditBtn').style.display = 'none';
        }

        function clearCommissionForm() {
            document.getElementById('commissionName').value = '';
            document.getElementById('commissionCode').value = '';
            document.getElementById('commissionResponsible').value = '';
            document.getElementById('commissionAdjoint').value = '';
            document.getElementById('commissionSecretary').value = '';
            document.getElementById('commissionTreasurer').value = '';
            document.getElementById('commissionDescription').value = '';
            document.getElementById('commissionSubCommissions').value = '';
        }

        function displayCommissions() {
            const list = document.getElementById('commissionsList');
            list.innerHTML = '';

            commissions.forEach((commission, index) => {
                const card = document.createElement('div');
                card.className = 'commission-card';
                card.innerHTML = `
                    <div class="commission-header">
                        <div class="commission-name">${commission.name} ${commission.code ? `(${commission.code})` : ''}</div>
                        <div>
                            <button class="btn btn-warning btn-small" onclick="editCommission(${index})">‚úèÔ∏è Modifier</button>
                            <button class="btn btn-danger btn-small" onclick="deleteCommission(${index})">üóëÔ∏è Supprimer</button>
                        </div>
                    </div>
                    <div class="commission-info">
                        <div class="info-item">
                            <div class="info-label">Responsable</div>
                            <div class="info-value">${commission.responsible}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Adjoint</div>
                            <div class="info-value">${commission.adjoint || 'Non renseign√©'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Secr√©taire</div>
                            <div class="info-value">${commission.secretary || 'Non renseign√©'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Tr√©sorier</div>
                            <div class="info-value">${commission.treasurer || 'Non applicable'}</div>
                        </div>
                    </div>
                    ${commission.description ? `<div style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px;"><strong>Description:</strong> ${commission.description}</div>` : ''}
                    ${commission.subCommissions && commission.subCommissions.length > 0 ? `
                        <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px;">
                            <strong>Sous-commissions:</strong>
                            <ul style="margin: 5px 0 0 20px;">
                                ${commission.subCommissions.map(sub => `<li>${sub}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                `;
                list.appendChild(card);
            });
        }

        // DOCUMENTS
        function saveDocument() {
            const title = document.getElementById('documentTitle').value;
            const fileInput = document.getElementById('fileInput');
            
            if (!title) {
                showError('documentError', 'Le titre est obligatoire');
                return;
            }

            const document = {
                id: Date.now(),
                title: title,
                commission: document.getElementById('documentCommission').value,
                category: document.getElementById('documentCategory').value,
                author: document.getElementById('documentAuthor').value,
                description: document.getElementById('documentDescription').value,
                fileName: fileInput.files[0] ? fileInput.files[0].name : null,
                fileSize: fileInput.files[0] ? fileInput.files[0].size : null,
                dateAdded: new Date().toLocaleDateString('fr-FR'),
                timeAdded: new Date().toLocaleTimeString('fr-FR')
            };

            documents.push(document);
            addActivity('Document ajout√©', title);
            saveData();
            clearDocumentForm();
            displayDocuments();
            showSuccess('documentSuccess');
        }

        function deleteDocument(index) {
            if (confirm('Supprimer ce document ?')) {
                const title = documents[index].title;
                documents.splice(index, 1);
                addActivity('Document supprim√©', title);
                saveData();
                displayDocuments();
            }
        }

        function clearDocumentForm() {
            document.getElementById('documentTitle').value = '';
            document.getElementById('documentCommission').value = '';
            document.getElementById('documentCategory').value = '';
            document.getElementById('documentAuthor').value = '';
            document.getElementById('documentDescription').value = '';
            document.getElementById('fileInput').value = '';
        }

        function displayDocuments() {
            const container = document.getElementById('documentsContainer');
            
            if (documents.length === 0) {
                container.innerHTML = '<p style="color: #6b7280; text-align: center;">Aucun document enregistr√©</p>';
                return;
            }

            container.innerHTML = '';
            documents.forEach((doc, index) => {
                const item = document.createElement('div');
                item.className = 'document-item';
                item.innerHTML = `
                    <div>
                        <div class="document-name">${doc.title}</div>
                        <div class="document-info">
                            ${doc.commission ? `Commission: ${doc.commission} | ` : ''}
                            ${doc.category ? `Cat√©gorie: ${doc.category} | ` : ''}
                            Ajout√© le ${doc.dateAdded}
                            ${doc.fileName ? `<br>üìé ${doc.fileName}` : ''}
                        </div>
                    </div>
                    <div>
                        <button class="btn btn-danger btn-small" onclick="deleteDocument(${index})">üóëÔ∏è</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        function updateCommissionsList() {
            const select = document.getElementById('documentCommission');
            select.innerHTML = '<option value="">Associer √† une commission (optionnel)</option>';
            
            commissions.forEach(commission => {
                const option = document.createElement('option');
                option.value = commission.name;
                option.textContent = commission.name;
                select.appendChild(option);
            });
        }

        // EXPORTS
        function exportMembersText() {
            if (members.length === 0) {
                alert('Aucun membre √† exporter');
                return;
            }

            let content = `LISTE DES MEMBRES AE2i\n`;
            content += `Export√© le: ${new Date().toLocaleString('fr-FR')}\n`;
            content += `Total: ${members.length} membres\n\n`;
            content += '='.repeat(50) + '\n\n';

            members.forEach((member, index) => {
                content += `${index + 1}. ${member.name.toUpperCase()}\n`;
                content += `   Email: ${member.email}\n`;
                content += `   T√©l√©phone: ${member.phone || 'Non renseign√©'}\n`;
                content += `   Poste: ${member.position || 'Non renseign√©'}\n`;
                content += `   Entreprise: ${member.company || 'Non renseign√©'}\n`;
                content += `   Statut: ${member.status || 'Non d√©fini'}\n`;
                content += `   Date d'int√©gration: ${member.joinDate || 'Non renseign√©'}\n`;
                if (member.notes) content += `   Notes: ${member.notes}\n`;
                content += '\n' + '-'.repeat(30) + '\n\n';
            });

            downloadTextFile(content, `AE2i_Membres_${new Date().toISOString().split('T')[0]}.txt`);
        }

        function exportCommissionsText() {
            if (commissions.length === 0) {
                alert('Aucune commission √† exporter');
                return;
            }

            let content = `LISTE DES COMMISSIONS AE2i\n`;
            content += `Export√© le: ${new Date().toLocaleString('fr-FR')}\n`;
            content += `Total: ${commissions.length} commissions\n\n`;
            content += '='.repeat(50) + '\n\n';

            commissions.forEach((commission, index) => {
                content += `${index + 1}. ${commission.name.toUpperCase()}`;
                content += commission.code ? ` (${commission.code})` : '';
                content += '\n';
                content += `   Responsable: ${commission.responsible}\n`;
                content += `   Adjoint: ${commission.adjoint || 'Non renseign√©'}\n`;
                content += `   Secr√©taire: ${commission.secretary || 'Non renseign√©'}\n`;
                content += `   Tr√©sorier: ${commission.treasurer || 'Non applicable'}\n`;
                if (commission.description) content += `   Description: ${commission.description}\n`;
                if (commission.subCommissions && commission.subCommissions.length > 0) {
                    content += `   Sous-commissions:\n`;
                    commission.subCommissions.forEach(sub => {
                        content += `     - ${sub}\n`;
                    });
                }
                content += '\n' + '-'.repeat(30) + '\n\n';
            });

            downloadTextFile(content, `AE2i_Commissions_${new Date().toISOString().split('T')[0]}.txt`);
        }

        function exportDocumentsText() {
            if (documents.length === 0) {
                alert('Aucun document √† exporter');
                return;
            }

            let content = `LISTE DES DOCUMENTS AE2i\n`;
            content += `Export√© le: ${new Date().toLocaleString('fr-FR')}\n`;
            content += `Total: ${documents.length} documents\n\n`;
            content += '='.repeat(50) + '\n\n';

            documents.forEach((doc, index) => {
                content += `${index + 1}. ${doc.title.toUpperCase()}\n`;
                content += `   Commission: ${doc.commission || 'Non associ√©'}\n`;
                content += `   Cat√©gorie: ${doc.category || 'Non d√©finie'}\n`;
                content += `   Auteur: ${doc.author || 'Non renseign√©'}\n`;
                content += `   Fichier: ${doc.fileName || 'Aucun fichier'}\n`;
                content += `   Ajout√© le: ${doc.dateAdded} √† ${doc.timeAdded}\n`;
                if (doc.description) content += `   Description: ${doc.description}\n`;
                content += '\n' + '-'.repeat(30) + '\n\n';
            });

            downloadTextFile(content, `AE2i_Documents_${new Date().toISOString().split('T')[0]}.txt`);
        }

        function exportAllData() {
            const date = new Date();
            const dateStr = date.toLocaleString('fr-FR');
            
            let content = `RAPPORT COMPLET AE2i\n`;
            content += `G√©n√©r√© le: ${dateStr}\n`;
            content += '='.repeat(60) + '\n\n';

            // Statistiques g√©n√©rales
            content += `STATISTIQUES G√âN√âRALES\n`;
            content += `- Membres totaux: ${members.length}\n`;
            content += `- Membres actifs: ${members.filter(m => m.status === 'actif').length}\n`;
            content += `- Commissions: ${commissions.length}\n`;
            content += `- Documents: ${documents.length}\n\n`;

            // Membres
            if (members.length > 0) {
                content += `MEMBRES (${members.length})\n`;
                content += '-'.repeat(30) + '\n';
                members.forEach((member, index) => {
                    content += `${index + 1}. ${member.name} - ${member.email} - ${member.status || 'Non d√©fini'}\n`;
                });
                content += '\n';
            }

            // Commissions
            if (commissions.length > 0) {
                content += `COMMISSIONS (${commissions.length})\n`;
                content += '-'.repeat(30) + '\n';
                commissions.forEach((commission, index) => {
                    content += `${index + 1}. ${commission.name} - Responsable: ${commission.responsible}\n`;
                });
                content += '\n';
            }

            // Documents
            if (documents.length > 0) {
                content += `DOCUMENTS (${documents.length})\n`;
                content += '-'.repeat(30) + '\n';
                documents.forEach((doc, index) => {
                    content += `${index + 1}. ${doc.title} - ${doc.dateAdded}\n`;
                });
            }

            downloadTextFile(content, `AE2i_Rapport_Complet_${new Date().toISOString().split('T')[0]}.txt`);
        }

        function downloadTextFile(content, fileName) {
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
        }

        // PARAM√àTRES
        function changePassword() {
            const current = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirm = document.getElementById('confirmPassword').value;

            if (!current || !newPass || !confirm) {
                showError('passwordError', 'Tous les champs sont obligatoires');
                return;
            }

            if (current !== currentPassword) {
                showError('passwordError', 'Mot de passe actuel incorrect');
                return;
            }

            if (newPass !== confirm) {
                showError('passwordError', 'Les mots de passe ne correspondent pas');
                return;
            }

            if (newPass.length < 6) {
                showError('passwordError', 'Le mot de passe doit contenir au moins 6 caract√®res');
                return;
            }

            currentPassword = newPass;
            saveData();
            showSuccess('settingsSuccess');
            
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('passwordInput').value = '';
            }
        }

        // UTILITAIRES
        function showSuccess(elementId) {
            const element = document.getElementById(elementId);
            element.classList.remove('hidden');
            setTimeout(() => {
                element.classList.add('hidden');
            }, 3000);
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.classList.remove('hidden');
            setTimeout(() => {
                element.classList.add('hidden');
            }, 5000);
        }

        // SAUVEGARDE / CHARGEMENT
        function saveData() {
            const data = {
                currentPassword: currentPassword,
                members: members,
                commissions: commissions,
                documents: documents,
                recentActivity: recentActivity,
                lastSave: new Date().toLocaleString('fr-FR')
            };

            // Sauvegarde locale (variables JavaScript)
            const saved = data;
            document.getElementById('lastSave').textContent = saved.lastSave;
        }

        function loadData() {
            // Chargement depuis les variables JavaScript (simulation)
            displayMembers();
            displayCommissions();
            displayDocuments();
            updateDashboard();
        }

        // INITIALISATION
        window.addEventListener('load', function() {
            loadData();
        });

        // Gestion de la touche Entr√©e pour la connexion
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });
    </script>
</body>
</html>
